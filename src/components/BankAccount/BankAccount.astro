---
import siteData from "@config/siteData.json";
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";

import avion from "@assets/images/plane.png";
import Title from "@components/Title/Title.astro";
---

<section
	id="account"
	class="mx-auto flex max-w-md scroll-mt-10 flex-col items-center px-4 py-8 text-center sm:max-w-lg md:max-w-2xl md:py-12 lg:max-w-4xl xl:max-w-6xl"
>
	<Title title="Sumando millas" />
	<!-- <h2 class="font-heading-1 mb-6 text-2xl sm:text-3xl md:text-4xl lg:mb-8">Sumando millas</h2> -->
	<Image
		src={avion}
		class="mx-auto w-48 transition-transform sm:w-56 md:w-64 lg:w-72"
		alt="wedding"
		aria-hidden="true"
		height={400}
	/>
	<p class="font-heading-1 my-6 max-w-prose text-base sm:text-lg md:text-xl lg:my-8">
		Tu presencia es lo más importante, pero si deseas ayudarnos a sumar millas a nuestro viaje,
		nuestra cuenta es...
	</p>
	<p
		class="mb-6 font-sans text-xl sm:text-2xl md:text-3xl lg:mb-8"
		data-account={siteData.wedding.account}
	>
		{siteData.wedding.account}
	</p>
	<button
		id="copyButton"
		class="text-primary hover:text-primary-dark group flex flex-col items-center justify-center transition-colors"
	>
		<Icon
			name="solar/copy-line-duotone"
			class="h-12 w-12 transition-transform group-hover:scale-110 sm:h-14 sm:w-14 md:h-16 md:w-16"
			aria-hidden="true"
		/>
		<span class="mt-2 text-sm sm:text-base">(clic para copiar)</span>
	</button>
</section>

<script>
	const copyButton = document.getElementById("copyButton");
	const accountNumber = document.querySelector("#account p:nth-of-type(2)");

	if (copyButton && accountNumber) {
		copyButton.addEventListener("click", async () => {
			try {
				await navigator.clipboard.writeText(accountNumber.textContent?.trim() || "");
				const originalText = copyButton.querySelector("span")?.textContent;

				if (copyButton.querySelector("span")) {
					copyButton.querySelector("span")!.textContent = "¡Copiado!";
					setTimeout(() => {
						if (originalText) {
							copyButton.querySelector("span")!.textContent = originalText;
						}
					}, 2000);
				}
			} catch (err) {
				console.error("Error al copiar:", err);
			}
		});
	}
</script>
